'use strict';

const assert = require('assert')
const { getSecurityVulnerabilitiesForGitHubOrg } = require('@silintl/vulnerability-scanner')

module.exports.scanOrg = async event => {
  assert(event.githubOrg, 'No githubOrg provided')
  assert(event.githubToken, 'No githubToken provided')
  assert(process.env.RESULTS_S3_BUCKET, 'No RESULTS_S3_BUCKET provided')

  console.log(
    `Told to scan ${event.githubOrg} and store results in ${process.env.RESULTS_S3_BUCKET}`
  )
  
  // return await getSecurityVulnerabilitiesForGitHubOrg(
  //   event.githubToken,
  //   event.githubOrg
  // )
}
